<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Coming Soon — Undefeatables</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="css/style.css"/>

  <!-- inline extras for cinematic + futuristic visuals -->
  <style>
    /* --- visual canvas layer --- */
    .visual-wrap {
      position: relative;
      overflow: hidden;
      border-radius: 18px;
      padding: 2rem;
      margin-top: 2rem;
      box-shadow: var(--shadow);
      background:
        radial-gradient(800px 240px at 10% 15%, rgba(123,75,255,0.06), transparent 6%),
        radial-gradient(600px 200px at 90% 85%, rgba(0,212,255,0.035), transparent 6%),
        linear-gradient(180deg, rgba(10,12,20,0.55), rgba(3,6,12,0.6));
    }

    /* canvas sits behind content */
    #bg-canvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
      mix-blend-mode: screen;
    }

    /* cinematic fog layers */
    .fog {
      position: absolute;
      inset: 0;
      z-index: 1;
      pointer-events: none;
      background: linear-gradient(180deg, rgba(6,8,14,0.0), rgba(6,8,14,0.3));
    }
    .fog::before, .fog::after {
      content: "";
      position: absolute;
      left: -20%;
      right: -20%;
      height: 40%;
      background: radial-gradient(50% 100% at 50% 50%, rgba(255,255,255,0.02), transparent 35%);
      transform: translateY(10%);
      opacity: 0.8;
      filter: blur(40px);
      animation: slowFloat 18s linear infinite;
    }
    .fog::after {
      top: 40%;
      opacity: 0.65;
      animation-duration: 26s;
      transform: translateY(-5%);
    }
    @keyframes slowFloat {
      0% { transform: translateX(-10%) translateY(0) scale(1); }
      50% { transform: translateX(10%) translateY(6%) scale(1.03); }
      100% { transform: translateX(-10%) translateY(0) scale(1); }
    }

    /* thin neon scanlines */
    .scanlines {
      position: absolute;
      inset: 0;
      z-index: 2;
      background-image:
        linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
      background-size: 300px 100%;
      opacity: 0.03;
      pointer-events: none;
      mix-blend-mode: overlay;
      animation: slideBG 45s linear infinite;
    }
    @keyframes slideBG { from { background-position: 0 0 } to { background-position: 300px 0 } }

    /* hero graphics + title */
    .coming-hero {
      position: relative;
      z-index: 3;
      text-align: center;
      color: #eaf1ff;
      padding: 3.2rem 1.25rem;
      backdrop-filter: blur(4px);
    }
    .coming-hero h1 {
      font-size: 3rem;
      margin: 0 0 .6rem;
      font-weight: 800;
      letter-spacing: -1px;
      line-height: 1.02;
      text-wrap: balance;
      text-shadow:
        0 8px 30px rgba(2,6,23,0.7),
        0 0 32px rgba(123,75,255,0.06);
      background: linear-gradient(90deg, rgba(196,107,255,0.95), rgba(123,75,255,0.95));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      transform: translateY(6px);
      opacity: 0;
      animation: revealUp .9s cubic-bezier(.2,.9,.2,1) .1s forwards;
    }

    .coming-hero .sub {
      color: var(--muted);
      font-size: 1.05rem;
      margin-bottom: 1.4rem;
      opacity: 0;
      transform: translateY(8px);
      animation: revealUp .9s cubic-bezier(.2,.9,.2,1) .25s forwards;
    }

    @keyframes revealUp {
      to { transform: translateY(0); opacity: 1; }
    }

    /* neon underline pulse */
    .hero-underscore {
      height: 6px;
      width: 180px;
      margin: 1.15rem auto 1.2rem;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--brand1), var(--brand2));
      box-shadow: 0 10px 40px rgba(123,75,255,0.14);
      opacity: 0;
      transform: scaleX(0.7);
      animation: underscoreIn .8s cubic-bezier(.2,.9,.2,1) .55s forwards;
    }
    @keyframes underscoreIn {
      to { opacity: 1; transform: scaleX(1); }
    }

    /* ============ WAITLIST UI (refined) ============ */
    .waitlist-box {
      max-width: 520px;
      margin: 1.6rem auto 0;
      padding: 1.25rem;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.018), rgba(255,255,255,0.01));
      box-shadow: 0 12px 48px rgba(2,6,23,0.6);
      position: relative;
      z-index: 4;
      border: 1px solid rgba(255,255,255,0.035);
      display: grid;
      gap: 0.9rem;
      align-items: center;
    }

    .waitlist-head {
      display:flex;
      gap:.6rem;
      align-items:center;
      justify-content:space-between;
    }
    .waitlist-head h3 {
      margin:0;
      font-size:1.05rem;
      font-weight:800;
      color:#eaf1ff;
    }
    .waitlist-subtle { color: var(--muted); font-size: .9rem; margin-left: .6rem; }

    .waitlist-form {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: .6rem;
      align-items: center;
    }

    /* input with icon */
    .input-wrap {
      position: relative;
      display: block;
    }
    .input-wrap svg {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      height: 18px;
      width: 18px;
      opacity: .9;
      color: rgba(255,255,255,0.7);
      pointer-events: none;
    }
    .waitlist-row input[type="email"] {
      width: 100%;
      padding: .86rem 1rem .86rem 40px; /* left space for icon */
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.04);
      background: rgba(7,16,34,0.62);
      color: #eaf1ff;
      font-size: 1rem;
      outline: none;
      transition: box-shadow .14s ease, transform .12s ease, border-color .12s ease;
    }
    .waitlist-row input[type="email"]::placeholder { color: rgba(234,241,255,0.45); }

    .waitlist-row input[type="email"]:focus {
      box-shadow: 0 8px 30px rgba(123,75,255,0.09);
      border-color: rgba(123,75,255,0.55);
      transform: translateY(-1px);
    }

    .waitlist-row .btn {
      padding: .78rem 1rem;
      border-radius: 12px;
      background: linear-gradient(90deg, rgba(196,107,255,0.98), rgba(0,212,255,0.95));
      color: #021024;
      font-weight: 900;
      border: none;
      cursor: pointer;
      box-shadow: 0 10px 36px rgba(123,75,255,0.14);
      min-width: 140px;
      transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
    }
    .waitlist-row .btn[disabled] { opacity: .6; cursor: default; transform: none; box-shadow: none; }
    .waitlist-row .btn:active { transform: translateY(1px); box-shadow: 0 8px 30px rgba(0,0,0,0.45); }

    .form-meta {
      display:flex;
      justify-content:space-between;
      gap:.6rem;
      align-items:center;
      margin-top: .2rem;
    }
    .muted-note { color: var(--muted); font-size:.88rem; }

    .ghost-btn { background: transparent; border:1px solid rgba(255,255,255,0.04); color:#dfeeff; padding:.5rem .8rem; border-radius:10px; text-decoration:none; font-weight:700; }

    /* inline error message */
    .input-error {
      color: #ffb4b4;
      font-size: .9rem;
      margin-top: .45rem;
      display: none;
      align-items: center;
      gap: .45rem;
    }
    .input-error.show { display: flex; }

    /* success toast (subtle) */
    .waitlist-success {
      display:flex;
      gap:.6rem;
      align-items:center;
      justify-content:center;
      margin-top:.6rem;
      padding:.6rem;
      border-radius:10px;
      background: linear-gradient(90deg, rgba(123,75,255,0.06), rgba(0,212,255,0.04));
      color: #eaf1ff;
      font-weight:700;
      text-align:center;
      box-shadow: 0 10px 36px rgba(2,6,23,0.6);
      transform: translateY(6px);
      opacity: 0;
      transition: transform .28s cubic-bezier(.2,.9,.2,1), opacity .28s;
      pointer-events: none;
    }
    .waitlist-success.show {
      transform: translateY(0);
      opacity: 1;
      pointer-events: auto;
    }

    /* Creator modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(2,6,23,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 1rem;
    }
    .modal-backdrop.show { display: flex; }
    .modal {
      width: 100%;
      max-width: 720px;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(7,10,16,0.95), rgba(3,6,12,0.95));
      box-shadow: 0 18px 60px rgba(2,6,23,0.8);
      padding: 1.15rem;
      border: 1px solid rgba(255,255,255,0.04);
      color: #eaf1ff;
    }
    .modal h4 { margin: 0 0 .6rem; font-size: 1.05rem; }
    .modal .modal-grid { display:grid; grid-template-columns: 1fr 1fr; gap:.6rem; margin-bottom:.6rem; }
    .modal input, .modal textarea {
      width: 100%;
      padding: .7rem .8rem;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.04);
      background: rgba(7,16,34,0.6);
      color: #eaf1ff;
      outline: none;
    }
    .modal textarea { min-height: 96px; resize:vertical; grid-column: 1 / -1; }
    .modal .modal-actions { display:flex; gap:.6rem; justify-content:flex-end; align-items:center; margin-top:.4rem; }
    .modal .btn-ghost { background:transparent; border:1px solid rgba(255,255,255,0.04); color:#eaf1ff; padding:.6rem .85rem; border-radius:10px; cursor:pointer; }

    /* responsive: stack on small screens */
    @media (max-width: 520px) {
      .waitlist-form { grid-template-columns: 1fr; }
      .waitlist-row .btn { width: 100%; min-width: auto; }
      .input-wrap svg { left: 12px; }
      .modal .modal-grid { grid-template-columns: 1fr; }
    }

    /* header + nav (added responsiveness & mobile toggle) */
    .header-wrap {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:1rem;
      padding: .75rem 0;
      z-index: 6;
    }
    .brand { display:flex; gap:.85rem; align-items:center; }
    .brand img { height:44px; width:auto; display:block; }
    .brand h2 { margin:0; font-size:1.1rem; color: #eaf1ff; }
    .brand .small { margin:0; color:var(--muted); font-size:.85rem; }

    nav { z-index: 8; }
    nav ul { display:flex; gap:1rem; list-style:none; margin:0; padding:0; align-items:center; }
    nav a { color: var(--muted); text-decoration:none; font-weight:700; padding:.4rem .6rem; border-radius:8px; }
    nav a:hover { color: #eaf1ff; background: rgba(255,255,255,0.02); }

    /* mobile toggle */
    .nav-toggle {
      display: none;
      background: transparent;
      border: 1px solid rgba(255,255,255,0.06);
      padding: .45rem;
      border-radius: 10px;
      color: #eaf1ff;
      cursor: pointer;
    }

    /* responsive tuning: reduce heavy visuals on small screens */
    @media (max-width: 700px) {
      .coming-hero h1 { font-size: 1.9rem; }
      .visual-wrap { padding: 1.25rem; margin-top: 1rem; }
      .accent-orb { display:none; }

      /* mobile nav: hide the inline list until toggled */
      nav ul { display: none; flex-direction: column; gap: 0; background: linear-gradient(180deg, rgba(7,16,34,0.85), rgba(3,6,12,0.85)); position: absolute; right: 10px; top: 68px; padding: .6rem; border-radius: 12px; min-width: 160px; box-shadow: 0 10px 30px rgba(2,6,23,0.7); border: 1px solid rgba(255,255,255,0.03); }
      nav ul.open { display: flex; }
      nav ul li { width:100%; }
      nav ul a { display:block; padding:.6rem .9rem; color:#eaf1ff; }
      .nav-toggle { display: inline-flex; align-items:center; justify-content:center; }
      .header-wrap { gap:.5rem; }
    }

    /* subtle footer glow */
    footer.site-footer {
      margin-top: 2rem;
      padding: 1rem 0;
      text-align: center;
      color: var(--muted);
      z-index: 6;
      position: relative;
    }
  </style>
</head>

<body>
  <main class="container">
    <!-- header -->
    <header class="header-wrap" style="position:relative; z-index:6;">
      <div class="brand">
        <img src="https://undefeatables.in/assets/logo-u.png" alt="Undefeatables logo">
        <div>
          <h2>Undefeatables</h2>
          <p class="small">Limitless. Fearless. Undefeatable.</p>
        </div>
      </div>

      <!-- mobile toggle -->
      <button class="nav-toggle" aria-expanded="false" aria-controls="main-nav" id="navToggle" aria-label="Toggle navigation">
        <!-- simple hamburger icon -->
        <svg width="20" height="14" viewBox="0 0 20 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect width="20" height="2" rx="1" fill="currentColor"/>
          <rect y="6" width="20" height="2" rx="1" fill="currentColor"/>
          <rect y="12" width="20" height="2" rx="1" fill="currentColor"/>
        </svg>
      </button>

      <nav id="main-nav" aria-label="Main navigation">
        <ul id="navList">
          <li><a href="/about.html">About</a></li>
          <li><a href="/contact.html">Contact</a></li>
        </ul>
      </nav>
    </header>

    <!-- visual container -->
    <section class="visual-wrap">
      <!-- canvas for particles -->
      <canvas id="bg-canvas" aria-hidden="true"></canvas>

      <!-- cinematic fog + scanlines -->
      <div class="fog" aria-hidden="true"></div>
      <div class="scanlines" aria-hidden="true"></div>

      <!-- floating orbs for depth -->
      <div class="accent-orb" style="left:-9%; top:8%;"></div>
      <div class="accent-orb right" style="right:-9%; bottom:12%;"></div>

      <!-- content -->
      <div class="coming-hero">
        <h1>Become Limitless — Launching Soon</h1>
        <div class="hero-underscore" aria-hidden="true"></div>
        <p class="sub">Creator-led skill courses, project-first learning, and a community that ships work — built for people who actually do.</p>

        <!-- WAITLIST (refined markup) -->
        <div class="waitlist-box" aria-live="polite">
          <div class="waitlist-head">
            <div style="display:flex;align-items:center;gap:.5rem;">
              <h3>Get Early Access</h3>
              <div class="waitlist-subtle">Be first to join!</div>
            </div>
            <button id="openCreator" class="ghost-btn" style="font-size:.9rem;">Apply as Creator</button>
          </div>

          <form id="waitlistForm" class="waitlist-form" action="#" method="POST" novalidate>
            <div class="input-wrap" style="min-width:0;">
              <!-- email icon -->
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 6.5A2.5 2.5 0 015.5 4h13A2.5 2.5 0 0121 6.5v11A2.5 2.5 0 0118.5 20h-13A2.5 2.5 0 013 17.5v-11z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/><path d="M21 6l-9 7L3 6" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>

              <input id="wl-email" type="email" name="email" placeholder="you@domain.com" required aria-label="email" autocomplete="email">
              <div id="emailError" class="input-error" aria-hidden="true">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="opacity:.9;"><path d="M12 8v4" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 16h.01" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span id="emailErrorText">Please enter a valid email.</span>
              </div>
            </div>

            <div style="display:flex;flex-direction:column;gap:.6rem;align-items:stretch;">
              <button class="btn" type="submit" id="wl-submit" aria-live="polite">Join Waitlist</button>
            </div>

            <!-- meta row, visually hidden on small grid layout but kept for semantics -->
            <div style="grid-column:1 / -1;">
              <div class="form-meta">
                <p class="muted-note">We respect your privacy — no spam.</p>
                <p style="font-size:.85rem;color:var(--muted);margin:0;">&nbsp;</p>
              </div>
            </div>
          </form>

          <div id="waitlistSuccess" class="waitlist-success" role="status" aria-live="polite">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <span id="waitMsg">Thanks — you’re on the list! Check your inbox for updates.</span>
          </div>
        </div>

        <div class="creator-cta">
        </div>

      </div>
    </section>

  </main>

  <footer class="site-footer">© 2025 Undefeatables — All rights reserved.</footer>

  <!-- Creator modal -->
  <!--<div id="creatorModal" class="modal-backdrop" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="creatorTitle">
    <div class="modal" role="document">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <h4 id="creatorTitle">Apply as Creator</h4>
        <button id="closeCreator" class="btn-ghost" aria-label="Close creator form">Close</button>
      </div>

      <form id="creatorForm" style="margin-top:.6rem;">
        <div class="modal-grid">
          <input id="creator-name" type="text" placeholder="Your name" required>
          <input id="creator-email" type="email" placeholder="Email" required>
          <input id="creator-portfolio" type="url" placeholder="Portfolio / Website (optional)">
          <input id="creator-role" type="text" placeholder="What do you teach? (e.g. Product, Design, ML)" >
        </div>
        <textarea id="creator-note" placeholder="A short pitch — what you'll create and why (optional)"></textarea>

        <div class="modal-actions">
          <button type="button" class="btn-ghost" id="creatorCancel">Cancel</button>
          <button type="submit" class="btn" id="creatorSubmit">Apply</button>
        </div>

        <div id="creatorSuccess" class="waitlist-success" style="margin-top:.8rem; display:none;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <span id="creatorMsg">Thanks — we received your application.</span>
        </div>
      </form>
    </div>
  </div>-->

  <!-- Keep your common scripts -->
  <script src="js/script.js" defer></script>

  <!-- inline JS: particles, reduced mode -->
  <script>
    /* ---------------------------
       Particle field (lightweight)
       --------------------------- */
    (function(){
      const canvas = document.getElementById('bg-canvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');
      let DPR = Math.min(window.devicePixelRatio || 1, 2);
      let w = canvas.width = canvas.clientWidth * DPR;
      let h = canvas.height = canvas.clientHeight * DPR;

      const reduced = window.matchMedia('(max-width:700px)').matches || (navigator.deviceMemory && navigator.deviceMemory < 2);

      const PARTICLE_COUNT = reduced ? 18 : 48;
      const particles = [];

      function rand(min, max){ return Math.random()*(max-min)+min; }

      function init(){
        DPR = Math.min(window.devicePixelRatio || 1, 2);
        w = canvas.width = canvas.clientWidth * DPR;
        h = canvas.height = canvas.clientHeight * DPR;
        particles.length = 0;
        for(let i=0;i<PARTICLE_COUNT;i++){
          particles.push({
            x: rand(0,w),
            y: rand(0,h),
            r: rand(0.6, 2.6) * DPR,
            vx: rand(-0.12,0.12),
            vy: rand(-0.06,0.06),
            hue: rand(180, 280),
            alpha: rand(0.08, 0.35)
          });
        }
      }

      function draw(){
        ctx.clearRect(0,0,w,h);
        // subtle gradient glow background (adds cinematic depth)
        const g = ctx.createLinearGradient(0,0,w,h);
        g.addColorStop(0, 'rgba(123,75,255,0.02)');
        g.addColorStop(1, 'rgba(0,212,255,0.01)');
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        // moving thin lines (scan-like)
        ctx.globalCompositeOperation = 'lighter';
        particles.forEach(p=>{
          p.x += p.vx;
          p.y += p.vy;
          if(p.x < -20) p.x = w + 20;
          if(p.x > w + 20) p.x = -20;
          if(p.y < -20) p.y = h + 20;
          if(p.y > h + 20) p.y = -20;

          // glow
          const grd = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r*6);
          const color = `hsla(${p.hue}, 85%, 60%, ${p.alpha})`;
          grd.addColorStop(0, color);
          grd.addColorStop(0.2, 'rgba(255,255,255,0.02)');
          grd.addColorStop(1, 'transparent');
          ctx.fillStyle = grd;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r*6, 0, Math.PI*2);
          ctx.fill();

          // core dot
          ctx.beginPath();
          ctx.fillStyle = `hsla(${p.hue}, 85%, 60%, ${Math.min(1,p.alpha*2)})`;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
          ctx.fill();
        });
        ctx.globalCompositeOperation = 'source-over';
      }

      let raf;
      function loop(){
        draw();
        raf = requestAnimationFrame(loop);
      }

      // init + start
      init();
      if(!reduced) loop();

      // on resize re-init
      let resizeTO;
      window.addEventListener('resize', ()=>{
        cancelAnimationFrame(raf);
        clearTimeout(resizeTO);
        resizeTO = setTimeout(()=>{ init(); if(!reduced) loop(); }, 250);
      });

      // small performance guard: stop particles on hidden page
      document.addEventListener('visibilitychange', ()=>{
        if(document.hidden) cancelAnimationFrame(raf);
        else loop();
      });
    })();
  </script>

  <!-- Nav Toggle + Waitlist + Creator handler -->
  <script type="module">
    // ----------------------
    // Mobile nav toggle
    // ----------------------
    const navToggle = document.getElementById('navToggle');
    const navList = document.getElementById('navList');

    if(navToggle && navList){
      navToggle.addEventListener('click', () => {
        const isOpen = navList.classList.toggle('open');
        navToggle.setAttribute('aria-expanded', String(isOpen));
      });

      // Close nav on outside click (mobile)
      document.addEventListener('click', (e) => {
        const target = e.target;
        if (!navList.contains(target) && !navToggle.contains(target) && navList.classList.contains('open')) {
          navList.classList.remove('open');
          navToggle.setAttribute('aria-expanded', 'false');
        }
      });
    }

    // ----------------------
    // Firebase (modular) setup - v12
    // ----------------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-analytics.js";

    // Your web app's Firebase configuration (you already placed credentials here)
    const firebaseConfig = {
      apiKey: "AIzaSyBJ79YElN89gT4U-4z339kAE4JjnPobMr0",
      authDomain: "undef-wait-v1.firebaseapp.com",
      projectId: "undef-wait-v1",
      storageBucket: "undef-wait-v1.appspot.com",
      messagingSenderId: "766114938290",
      appId: "1:766114938290:web:8f2b25d5ac00cb0f16f8ab",
      measurementId: "G-YG1T6LZ6F6"
    };

    let db = null;
    try {
      const app = initializeApp(firebaseConfig);
      // analytics is optional; wrap in try because it can fail in some environments
      try { getAnalytics(app); } catch(e) { /* ignore analytics failure */ }
      db = getFirestore(app);
    } catch (err) {
      console.warn('Firebase init failed — falling back to local-only. Error:', err);
      db = null;
    }

    // ----------------------
    // Waitlist logic
    // ----------------------
    const waitlistForm = document.getElementById('waitlistForm');
    const emailInput = document.getElementById('wl-email');
    const submitBtn = document.getElementById('wl-submit');
    const successEl = document.getElementById('waitlistSuccess');
    const emailError = document.getElementById('emailError');
    const emailErrorText = document.getElementById('emailErrorText');
    const waitMsg = document.getElementById('waitMsg');

    function fallbackStore(key, payload){
      const arr = JSON.parse(localStorage.getItem(key) || '[]');
      arr.push(payload);
      localStorage.setItem(key, JSON.stringify(arr));
    }

    function showError(message){
      if(emailError && emailErrorText){
        emailErrorText.textContent = message;
        emailError.classList.add('show');
        setTimeout(()=> emailError.classList.remove('show'), 4500);
      } else {
        alert(message);
      }
    }

    function showSuccess(message){
      if(successEl && waitMsg){
        waitMsg.textContent = message || 'Thanks — you’re on the list! Check your inbox for updates.';
        successEl.classList.add('show');
        setTimeout(()=> successEl.classList.remove('show'), 7000);
      } else {
        alert(message || 'Added to waitlist');
      }
    }

    function isValidEmail(v){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
    }

    let inflight = false;
    if(waitlistForm){
      waitlistForm.addEventListener('submit', async (ev) => {
        ev.preventDefault();
        if(inflight) return;
        const email = (emailInput && emailInput.value || '').trim();
        if(!email){
          showError('Email cannot be empty.');
          return;
        }
        if(!isValidEmail(email)){
          showError('Please enter a valid email address.');
          return;
        }

        inflight = true;
        submitBtn.disabled = true;
        const oldTxt = submitBtn.innerText;
        submitBtn.innerText = 'Adding...';

        let saved = false;

        // Try Firestore first (fast path)
        if(db){
          try {
            await addDoc(collection(db, 'waitlist'), {
              email,
              createdAt: serverTimestamp(),
              source: 'site'
            });
            saved = true;
            showSuccess('You’ve been added to the waitlist — check your email for updates.');
          } catch (err) {
            console.warn('Firestore add failed:', err);
          }
        }

        // If Firestore failed, attempt API endpoint (if you have one)
        if(!saved){
          try {
            const res = await fetch('/api/waitlist', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ email })
            });
            if(res && res.ok){
              saved = true;
              showSuccess('You’ve been added to the waitlist — check your email for updates.');
            }
          } catch (e) {
            // ignore
          }
        }

        // final fallback: store locally
        if(!saved){
          fallbackStore('ud_waitlist_v1', { email, at: new Date().toISOString() });
          showSuccess('Added to local waitlist (demo). We will migrate this when backend is ready.');
        }

        submitBtn.innerText = oldTxt;
        submitBtn.disabled = false;
        inflight = false;
        if(emailInput) emailInput.value = '';
      });
    }

    // enable submit only when looks like an email
    if(emailInput && submitBtn){
      function updateSubmitState(){
        const v = (emailInput.value || '').trim();
        submitBtn.disabled = !isValidEmail(v);
      }
      emailInput.addEventListener('input', updateSubmitState);
      updateSubmitState();
    }

    // ----------------------
    // Creator modal + handler
    // ----------------------
    const openCreatorBtn = document.getElementById('openCreator');
    const creatorModal = document.getElementById('creatorModal');
    const closeCreatorBtn = document.getElementById('closeCreator');
    const creatorCancel = document.getElementById('creatorCancel');
    const creatorForm = document.getElementById('creatorForm');
    const creatorSubmit = document.getElementById('creatorSubmit');
    const creatorSuccess = document.getElementById('creatorSuccess');
    const creatorMsg = document.getElementById('creatorMsg');

    function showCreatorModal(show = true){
      if(show){
        creatorModal.classList.add('show');
        creatorModal.setAttribute('aria-hidden', 'false');
        // focus first input for accessibility
        setTimeout(()=> document.getElementById('creator-name')?.focus(), 120);
      } else {
        creatorModal.classList.remove('show');
        creatorModal.setAttribute('aria-hidden', 'true');
      }
    }

    openCreatorBtn?.addEventListener('click', (e) => {
      e.preventDefault();
      showCreatorModal(true);
    });
    closeCreatorBtn?.addEventListener('click', () => showCreatorModal(false));
    creatorCancel?.addEventListener('click', () => showCreatorModal(false));
    // close on backdrop click
    creatorModal?.addEventListener('click', (e) => {
      if(e.target === creatorModal) showCreatorModal(false);
    });

    // Creator submission logic
    creatorForm?.addEventListener('submit', async (ev) => {
      ev.preventDefault();
      const name = (document.getElementById('creator-name')?.value || '').trim();
      const email = (document.getElementById('creator-email')?.value || '').trim();
      const portfolio = (document.getElementById('creator-portfolio')?.value || '').trim();
      const role = (document.getElementById('creator-role')?.value || '').trim();
      const note = (document.getElementById('creator-note')?.value || '').trim();

      if(!name) { alert('Please enter your name.'); return; }
      if(!isValidEmail(email)){ alert('Please enter a valid email.'); return; }

      creatorSubmit.disabled = true;
      const old = creatorSubmit.innerText;
      creatorSubmit.innerText = 'Sending...';

      let saved = false;
      if(db){
        try {
          await addDoc(collection(db, 'creators'), {
            name, email, portfolio: portfolio || null, role: role || null, note: note || null,
            createdAt: serverTimestamp(),
            status: 'pending'
          });
          saved = true;
          creatorMsg.textContent = 'Thanks — we received your application. We will reach out soon.';
          creatorSuccess.style.display = 'flex';
          setTimeout(()=> { creatorSuccess.style.display = 'none'; showCreatorModal(false); }, 4000);
        } catch (err) {
          console.warn('Firestore creators add failed:', err);
        }
      }

      // fallback to endpoint
      if(!saved){
        try {
          const res = await fetch('/api/creators', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, email, portfolio, role, note })
          });
          if(res && res.ok){
            saved = true;
            creatorMsg.textContent = 'Thanks — we received your application. We will reach out soon.';
            creatorSuccess.style.display = 'flex';
            setTimeout(()=> { creatorSuccess.style.display = 'none'; showCreatorModal(false); }, 4000);
          }
        } catch (e) {
          // ignore
        }
      }

      if(!saved){
        // fallback to localStorage
        fallbackStore('ud_creators_v1', { name, email, portfolio, role, note, at: new Date().toISOString() });
        creatorMsg.textContent = 'Saved locally (demo). We will migrate applications when backend is ready.';
        creatorSuccess.style.display = 'flex';
        setTimeout(()=> { creatorSuccess.style.display = 'none'; showCreatorModal(false); }, 4000);
      }

      creatorSubmit.disabled = false;
      creatorSubmit.innerText = old;
      creatorForm.reset();
    });
  </script>

</body>
</html>
